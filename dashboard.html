<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />

  <!-- 즉시 로그인 세션 검증 -->
  <script>
    (function () {
      try {
        const raw = localStorage.getItem("korual_user");
        if (!raw) return location.replace("index.html");
        const user = JSON.parse(raw);
        if (!user || !user.username) return location.replace("index.html");
      } catch {
        return location.replace("index.html");
      }
    })();
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KORUAL CONTROL CENTER</title>

  <link rel="stylesheet" href="style.css" />
</head>

<body>
<div class="app-shell">

  <!-- ======================================
       ■ 사이드바
  ======================================= -->
  <aside class="sidebar">
    <div class="brand-title">KORUAL</div>
    <div class="brand-subtitle">Control Center</div>

    <nav class="nav">
      <button class="nav-link active" data-section="dashboard">📊 대시보드</button>
      <button class="nav-link" data-section="products">📦 상품 관리</button>
      <button class="nav-link" data-section="orders">📮 주문 관리</button>
      <button class="nav-link" data-section="members">🧑‍🤝‍🧑 회원 관리</button>
      <button class="nav-link" data-section="stock">🏬 재고 관리</button>
      <button class="nav-link" data-section="logs">📝 로그</button>
    </nav>

    <div class="sidebar-footer">
      <div class="api-status">● API 연결 상태</div>
      <div class="api-meta">
        Ping: <span id="apiPing">- ms</span>
      </div>
    </div>
  </aside>

  <div id="sidebarBackdrop" class="sidebar-backdrop"></div>

  <!-- ======================================
       ■ 메인 컨텐츠
  ======================================= -->
  <main class="content">

    <!-- 상단바 -->
    <header class="topbar">
      <div class="topbar-left">

        <!-- 모바일 -->
        <button id="menuToggle" class="mobile-menu-btn">
          <span></span><span></span><span></span>
        </button>

        <div class="topbar-text">
          <div class="topbar-title">KORUAL CONTROL CENTER</div>
          <div class="topbar-meta">
            반갑습니다, <span id="welcomeUser">KORUAL</span>님
            <span class="last-sync" id="last-sync">마지막 동기화: -</span>
          </div>
        </div>
      </div>

      <div class="topbar-right">
        <!-- 테마 -->
        <button id="themeToggle" class="theme-toggle">
          <span class="theme-toggle-label" data-light="Light" data-dark="Dark">Light</span>
          <span class="theme-toggle-track">
            <span class="theme-toggle-thumb"></span>
          </span>
        </button>

        <!-- 새로고침 -->
        <button id="btnRefreshAll" class="primary-btn">🔄 새로고침</button>

        <!-- 로그아웃 -->
        <button id="btnLogout" class="ghost-btn logout-btn">로그아웃</button>
      </div>
    </header>
    <!-- ============================================================
         1) 대시보드
    ============================================================ -->
    <section id="section-dashboard" class="section active">

      <div class="section-header-row">
        <div>
          <h2>📊 대시보드</h2>
          <p class="section-desc">전체 운영 데이터를 실시간으로 요약합니다.</p>
        </div>
      </div>

      <!-- 요약 카드 -->
      <div class="cards-grid">
        <div class="card">
          <div class="card-label">총 상품 수</div>
          <div class="card-value" id="cardTotalProducts">-</div>
        </div>
        <div class="card">
          <div class="card-label">총 주문 수</div>
          <div class="card-value" id="cardTotalOrders">-</div>
        </div>
        <div class="card">
          <div class="card-label">추정 매출 합계</div>
          <div class="card-value" id="cardTotalRevenue">-</div>
        </div>
        <div class="card">
          <div class="card-label">회원 수</div>
          <div class="card-value" id="cardTotalMembers">-</div>
        </div>
      </div>

      <!-- 오늘 요약 -->
      <div class="panel">
        <div class="panel-header"><h3>오늘 요약</h3></div>

        <div class="panel-body">
          <div class="today-metrics">

            <div class="today-metric">
              <span class="today-label">오늘 주문</span>
              <span class="today-value" id="todayOrders">-</span>
            </div>

            <div class="today-metric">
              <span class="today-label">오늘 매출</span>
              <span class="today-value" id="todayRevenue">-</span>
            </div>

            <div class="today-metric">
              <span class="today-label">준비중 주문</span>
              <span class="today-value" id="todayPending">-</span>
            </div>

          </div>
        </div>
      </div>

      <!-- 최근 주문 -->
      <div class="panel">
        <div class="panel-header">
          <h3>최근 주문</h3>
          <button id="goOrders" class="ghost-btn small">→ 주문 관리</button>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>주문일자</th>
                <th>주문번호</th>
                <th>상품명</th>
                <th>수량</th>
                <th>금액</th>
                <th>채널</th>
                <th>상태</th>
              </tr>
            </thead>
            <tbody id="recentOrdersBody">
              <tr><td colspan="7" class="empty-state">로딩중…</td></tr>
            </tbody>
          </table>
        </div>
      </div>

    </section>


    <!-- ============================================================
         2) 상품 관리
    ============================================================ -->
    <section id="section-products" class="section">

      <div class="section-header-row">
        <div>
          <h2>📦 상품 관리</h2>
          <p class="section-desc">상품 정보 및 판매가/재고를 확인합니다.</p>
        </div>

        <div class="section-actions">
          <input id="searchProducts" class="input" placeholder="검색 (상품명 / 코드 / 옵션)" />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>상품코드</th>
              <th>상품명</th>
              <th>옵션</th>
              <th>판매가</th>
              <th>재고</th>
            </tr>
          </thead>

          <tbody id="productsBody">
            <tr><td colspan="5" class="empty-state">데이터 없음</td></tr>
          </tbody>
        </table>
      </div>

    </section>


    <!-- ============================================================
         3) 주문 관리
    ============================================================ -->
    <section id="section-orders" class="section">

      <div class="section-header-row">
        <div>
          <h2>📮 주문 관리</h2>
          <p class="section-desc">전체 주문 목록 및 배송 상태 관리</p>
        </div>

        <div class="section-actions">
          <input id="searchOrders" class="input" placeholder="검색 (주문번호 / 고객명 / 상태)" />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>회원번호</th>
              <th>날짜</th>
              <th>주문번호</th>
              <th>고객명</th>
              <th>상품명</th>
              <th>수량</th>
              <th>금액</th>
              <th>상태</th>
            </tr>
          </thead>

          <tbody id="ordersBody">
            <tr><td colspan="8" class="empty-state">데이터 없음</td></tr>
          </tbody>
        </table>
      </div>

    </section>
    <!-- ============================================================
         4) 회원 관리
    ============================================================ -->
    <section id="section-members" class="section">

      <div class="section-header-row">
        <div>
          <h2>🧍 회원 관리</h2>
          <p class="section-desc">회원 정보, 등급, 누적매출, 최근 주문일을 확인합니다.</p>
        </div>

        <div class="section-actions">
          <input id="searchMembers" class="input" placeholder="검색 (회원번호 / 이름 / 이메일 / 전화번호 / 등급)" />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>회원번호</th>
              <th>이름</th>
              <th>전화번호</th>
              <th>이메일</th>
              <th>가입일</th>
              <th>채널</th>
              <th>등급</th>
              <th>누적매출</th>
              <th>포인트</th>
              <th>최근주문일</th>
              <th>메모</th>
            </tr>
          </thead>

          <tbody id="membersBody">
            <tr><td colspan="11" class="empty-state">데이터 없음</td></tr>
          </tbody>
        </table>
      </div>

    </section>


    <!-- ============================================================
         5) 재고 관리
    ============================================================ -->
    <section id="section-stock" class="section">

      <div class="section-header-row">
        <div>
          <h2>🏷️ 재고 관리</h2>
          <p class="section-desc">입고/출고 없이도 자동 카운팅된 재고를 확인합니다.</p>
        </div>

        <div class="section-actions">
          <input id="searchStock" class="input" placeholder="검색 (상품코드 / 상품명 / 상태 / 창고)" />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>상품코드</th>
              <th>상품명</th>
              <th>현재 재고</th>
              <th>안전 재고</th>
              <th>상태</th>
              <th>창고</th>
              <th>채널</th>
            </tr>
          </thead>

          <tbody id="stockBody">
            <tr><td colspan="7" class="empty-state">데이터 없음</td></tr>
          </tbody>
        </table>
      </div>

    </section>


    <!-- ============================================================
         6) 로그 모니터링
    ============================================================ -->
    <section id="section-logs" class="section">

      <div class="section-header-row">
        <div>
          <h2>📘 로그 모니터링</h2>
          <p class="section-desc">자동화 기록, 알림 로그, API 호출 로그를 확인합니다.</p>
        </div>

        <div class="section-actions">
          <input id="searchLogs" class="input" placeholder="검색 (시간 / 타입 / 메시지)" />
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>시간</th>
              <th>타입</th>
              <th>메시지</th>
            </tr>
          </thead>

          <tbody id="logsBody">
            <tr><td colspan="3" class="empty-state">데이터 없음</td></tr>
          </tbody>
        </table>
      </div>

    </section>


    <!-- ============================================================
          FOOTER (선택)
    ============================================================ -->
    <footer class="footer">
      <div class="footer-inner">
        <span>© 2025 KORUAL Control Center · All Systems Automated</span>
      </div>
    </footer>

  </main>
  </div>

  <!-- JS 연결 -->
  <script src="app.js"></script>

</body>
</html>
